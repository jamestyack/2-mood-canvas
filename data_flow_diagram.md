# ğŸ¨ MoodCanvas Data Flow

## User Input â†’ Playlist + Image Generation

```
ğŸ‘¤ USER INPUT
"I feel like floating through fog at dawn"
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ§  GPT-4o MOOD ANALYSIS         â”‚
â”‚        (mood_to_music.py)               â”‚
â”‚                                         â”‚
â”‚ PROMPT TO GPT-4o:                       â”‚
â”‚ "Analyze this mood and return JSON:     â”‚
â”‚  - emotional_tags: 2-3 emotions         â”‚
â”‚  - genres: 2-3 music genres             â”‚
â”‚  - playlist_name: creative name"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
ğŸ“‹ GPT-4o OUTPUT (JSON)
{
  "emotional_tags": ["calm", "dreamy"],
  "genres": ["ambient", "folk"],
  "playlist_name": "Dawn Drift"
}
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚                       â”‚
â–¼                 â–¼                       â–¼
```

## Left Path: ğŸµ Spotify Playlist Creation

```
ğŸµ SPOTIFY SEARCH
(spotify_client.py)

INPUT: ["ambient", "folk"]
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ğŸ” Spotify API Track Search          â”‚
â”‚                                         â”‚
â”‚ FOR EACH GENRE:                         â”‚
â”‚ â€¢ Query: "genre:ambient"                â”‚
â”‚ â€¢ Query: "genre:folk"                   â”‚
â”‚ â€¢ Fallback: search by keyword           â”‚
â”‚                                         â”‚
â”‚ RETURNS: List of track objects          â”‚
â”‚ [{                                      â”‚
â”‚   "name": "Song Name",                  â”‚
â”‚   "artist": "Artist Name",              â”‚
â”‚   "uri": "spotify:track:...",           â”‚
â”‚   "preview_url": "https://...",         â”‚
â”‚   "external_url": "https://..."        â”‚
â”‚ }]                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
ğŸ¶ PLAYLIST CREATION
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ğŸ“ Create Playlist with Metadata     â”‚
â”‚                                         â”‚
â”‚ NAME: "Dawn Drift"                      â”‚
â”‚                                         â”‚
â”‚ DESCRIPTION:                            â”‚
â”‚ "Generated by MoodCanvas ğŸ¨ |           â”‚
â”‚  Mood: 'floating through fog at dawn' | â”‚
â”‚  Emotions: calm, dreamy |               â”‚
â”‚  Genres: ambient, folk"                 â”‚
â”‚                                         â”‚
â”‚ TRACKS: [5-15 track URIs]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
ğŸ§ RESULT: Spotify Playlist URL
```

## Right Path: ğŸ¨ Image Generation

```
ğŸ¨ IMAGE PROMPT CREATION
(image_generator.py)

INPUT: 
- emotional_tags: ["calm", "dreamy"]
- genres: ["ambient", "folk"] 
- mood_text: "floating through fog at dawn"
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ğŸ§© PROMPT ENGINEERING             â”‚
â”‚                                         â”‚
â”‚ 1. EMOTION â†’ VISUAL MAPPING:            â”‚
â”‚    "calm" â†’ "serene, peaceful, soft lighting" â”‚
â”‚    "dreamy" â†’ "ethereal, floating elements"   â”‚
â”‚                                         â”‚
â”‚ 2. GENRE â†’ AESTHETIC MAPPING:           â”‚
â”‚    "ambient" â†’ "abstract soundwaves,    â”‚
â”‚                 atmospheric textures"   â”‚
â”‚    "folk" â†’ "natural landscapes,        â”‚
â”‚              acoustic instruments"      â”‚
â”‚                                         â”‚
â”‚ 3. COMBINE INTO DALL-E PROMPT:          â”‚
â”‚    "Abstract visual representation of   â”‚
â”‚     'floating through fog at dawn'.     â”‚
â”‚     serene, peaceful, soft lighting,    â”‚
â”‚     ethereal, floating elements,        â”‚
â”‚     abstract soundwaves, atmospheric    â”‚
â”‚     textures, natural landscapes.       â”‚
â”‚     Digital art style, no text"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
ğŸ¤– DALL-E 3 API CALL
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ¨ IMAGE GENERATION             â”‚
â”‚                                         â”‚
â”‚ â€¢ Model: "dall-e-3"                     â”‚
â”‚ â€¢ Size: 1024x1024                       â”‚
â”‚ â€¢ Quality: standard                     â”‚
â”‚                                         â”‚
â”‚ RETURNS: Image URL                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
ğŸ“¥ DOWNLOAD & CONVERT
           â”‚
           â–¼
ğŸ–¼ï¸ RESULT: Base64 Image Data
```

## Final Output to User

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ğŸ¨ MOODCANVAS RESULT         â”‚
â”‚                                         â”‚
â”‚ ğŸ­ MOOD ANALYSIS:                       â”‚
â”‚    â€¢ Tags: calm, dreamy                 â”‚
â”‚    â€¢ Genres: ambient, folk              â”‚
â”‚                                         â”‚
â”‚ ğŸµ SPOTIFY PLAYLIST:                    â”‚
â”‚    â€¢ Name: "Dawn Drift"                 â”‚
â”‚    â€¢ 15 tracks                          â”‚
â”‚    â€¢ Link to open in Spotify           â”‚
â”‚    â€¢ Rich metadata in description      â”‚
â”‚                                         â”‚
â”‚ ğŸ¨ AI ARTWORK:                          â”‚
â”‚    â€¢ Visual representation of mood     â”‚
â”‚    â€¢ Download button for PNG file      â”‚
â”‚    â€¢ Generated based on emotions +     â”‚
â”‚      musical aesthetics                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key API Calls Made

1. **OpenAI GPT-4o** (`mood_to_music.py:analyze_mood()`)
   - Input: Mood text
   - Output: Structured emotional analysis

2. **Spotify Web API** (`spotify_client.py:search_tracks()`)
   - Input: Genre list
   - Output: Track metadata

3. **Spotify Web API** (`spotify_client.py:create_playlist()`)
   - Input: Track URIs + metadata
   - Output: Playlist URL

4. **OpenAI DALL-E 3** (`image_generator.py:generate_mood_image()`)
   - Input: Engineered visual prompt
   - Output: AI-generated artwork

## Code Files Involved

- `app.py` - Orchestrates the entire flow
- `mood_to_music.py` - GPT-4o mood analysis
- `spotify_client.py` - Playlist creation
- `image_generator.py` - Image generation

Each component has error handling and fallbacks to ensure the experience works even if one API fails!